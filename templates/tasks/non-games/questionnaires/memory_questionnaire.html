{% extends 'layouts/base.html' %}
{% load static %}

{% block title %}Memory Questionnaire Results - CogniCare{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/tasks.css' %}">
{% endblock %}

{% block content %}
<div class="results-container">
    <div class="results-header">
        <h1>Memory Questionnaire Results</h1>
        <p>Analysis of your memory assessment responses</p>
    </div>

    {% if processed_results %}
    <div class="results-section">
        <h2 class="section-title">üìä Summary Statistics</h2>
        <div class="summary-grid">
            <div class="summary-card">
                <h3>Total Issues</h3>
                <p>{{ processed_results.total_issues }}</p>
                <div class="card-subtitle">Assessed</div>
            </div>
            <div class="summary-card">
                <h3>High Concern</h3>
                <p>{{ processed_results.high_concern_count }}</p>
                <div class="card-subtitle">Score ‚â• 4</div>
            </div>
            <div class="summary-card">
                <h3>Average Score</h3>
                <p>{{ processed_results.average_score|floatformat:1 }}</p>
                <div class="card-subtitle">Combined</div>
            </div>
        </div>
    </div>

    <div class="results-section">
        <h2 class="section-title">üòü High Concern Issues</h2>
        <p class="section-subtitle">Issues with a combined score of 4 or higher.</p>
        {% if processed_results.high_concern_issues %}
            <ul class="issue-list">
                {% for issue in processed_results.high_concern_issues %}
                <li>{{ issue.issue }} (Score: {{ issue.combined_score }})</li>
                {% endfor %}
            </ul>
        {% else %}
            <p class="empty-state">No high concern issues reported.</p>
        {% endif %}
    </div>

    <div class="results-section">
        <h2 class="section-title">ü§î Reported Memory Techniques</h2>
        {% if processed_results.techniques %}
            <ul class="technique-list">
                {% for technique in processed_results.techniques %}
                <li>{{ technique }}</li>
                {% endfor %}
            </ul>
        {% else %}
            <p class="empty-state">No specific memory techniques were reported.</p>
        {% endif %}
    </div>

    <div class="results-section">
        <h2 class="section-title">üìù Detailed Responses</h2>
        <div class="table-container">
            <table class="enhanced-table">
                <thead>
                    <tr>
                        <th>Memory Issue</th>
                        <th>Frequency</th>
                        <th>Seriousness</th>
                    </tr>
                </thead>
                <tbody>
                    {% for issue in processed_results.processed_issues %}
                    <tr>
                        <td>{{ issue.issue }}</td>
                        <td>{{ issue.frequency }}</td>
                        <td>{{ issue.seriousness }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% else %}
    <div class="empty-state">
        <p>There was an error processing the results for this questionnaire.</p>
    </div>
    {% endif %}

    <div class="footer-actions">
        <a href="{{ back_url }}" class="action-btn outline-btn">‚Üê Back to Tasks</a>
    </div>
</div>
{% endblock %} 